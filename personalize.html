<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lộ trình học tập cá nhân hóa - EduPath AI">
    <title>Cá nhân hóa - EduPath</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/personalize.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container nav-content">
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <i class="fa-solid fa-graduation-cap"></i>
                </div>
                <div class="logo-text">Edu<span>Path</span></div>
            </a>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Trang chủ</a></li>
                <li><a href="lookup.html" class="nav-link">Điểm chuẩn</a></li>
                <li><a href="analysis.html" class="nav-link">Phân tích</a></li>
                <li><a href="personalize.html" class="nav-link active">Cá nhân hóa</a></li>
                <li><a href="career.html" class="nav-link">Hướng nghiệp</a></li>
            </ul>
            <a href="chat.html" class="btn btn-gold">
                <i class="fa-solid fa-robot"></i> Hỏi đáp AI
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="personalize-main">
        <div class="container">
            <!-- No Data State -->
            <div class="no-data-state" id="no-data-state">
                <div class="no-data-icon">
                    <i class="fa-solid fa-chart-pie"></i>
                </div>
                <h2>Chưa có dữ liệu phân tích</h2>
                <p>Bạn cần thực hiện phân tích điểm thi thử trước để xem lộ trình cá nhân hóa</p>
                <a href="analysis.html" class="btn-primary-lg">
                    <i class="fa-solid fa-magnifying-glass-chart"></i>
                    Phân tích điểm ngay
                </a>
            </div>

            <!-- Personalized Dashboard (shown when has data) -->
            <div class="dashboard-content" id="dashboard-content" style="display: none;">
                <!-- Profile Header -->
                <div class="profile-header">
                    <div class="profile-info">
                        <div class="profile-avatar">
                            <i class="fa-solid fa-user-graduate"></i>
                        </div>
                        <div class="profile-details">
                            <h1>Lộ trình cá nhân hóa</h1>
                            <p class="target-text">
                                <i class="fa-solid fa-bullseye"></i>
                                Mục tiêu: <span id="target-major">--</span> - <span id="target-school">--</span>
                            </p>
                        </div>
                    </div>
                    <div class="profile-actions">
                        <button class="btn-outline" onclick="refreshAnalysis()">
                            <i class="fa-solid fa-rotate"></i> Cập nhật
                        </button>
                        <button class="btn-primary" onclick="exportPDF()">
                            <i class="fa-solid fa-download"></i> Tải PDF
                        </button>
                    </div>
                </div>

                <!-- Overview Cards -->
                <div class="overview-row">
                    <div class="metric-card probability">
                        <div class="metric-icon">
                            <i class="fa-solid fa-bullseye"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="metric-probability">--%</div>
                            <div class="metric-label">Khả năng đậu</div>
                            <div class="metric-badge" id="probability-badge">--</div>
                        </div>
                        <div class="metric-ring" id="probability-ring">
                            <svg viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="45" class="ring-bg" />
                                <circle cx="50" cy="50" r="45" class="ring-fill" id="ring-fill" />
                            </svg>
                        </div>
                    </div>

                    <div class="metric-card gap">
                        <div class="metric-icon">
                            <i class="fa-solid fa-arrows-up-down"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="metric-gap">-- điểm</div>
                            <div class="metric-label">Khoảng cách</div>
                            <div class="metric-sub" id="gap-description">--</div>
                        </div>
                    </div>

                    <div class="metric-card score">
                        <div class="metric-icon">
                            <i class="fa-solid fa-chart-simple"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="metric-score">--</div>
                            <div class="metric-label">Điểm xét tuyển</div>
                            <div class="metric-sub">Mục tiêu: <span id="target-score">--</span></div>
                        </div>
                    </div>

                    <div class="metric-card days">
                        <div class="metric-icon">
                            <i class="fa-solid fa-calendar-days"></i>
                        </div>
                        <div class="metric-content">
                            <div class="metric-value" id="metric-days">--</div>
                            <div class="metric-label">Ngày còn lại</div>
                            <div class="metric-sub">đến kỳ thi THPT 2026</div>
                        </div>
                    </div>
                </div>

                <!-- Two Column Layout -->
                <div class="content-grid">
                    <!-- Left Column -->
                    <div class="left-column">
                        <!-- AI Analysis Section -->
                        <div class="card ai-card">
                            <div class="card-header">
                                <div class="header-icon ai">
                                    <i class="fa-solid fa-sparkles"></i>
                                </div>
                                <h2>AI Đánh giá & Tư vấn</h2>
                                <button class="btn-icon" onclick="refreshAI()" title="Làm mới">
                                    <i class="fa-solid fa-rotate"></i>
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="ai-response" id="ai-response">
                                    <div class="ai-loading">
                                        <i class="fa-solid fa-spinner fa-spin"></i>
                                        <span>AI đang phân tích...</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Subject Analysis -->
                        <div class="card">
                            <div class="card-header">
                                <div class="header-icon subjects">
                                    <i class="fa-solid fa-chart-bar"></i>
                                </div>
                                <h2>Phân tích điểm mạnh/yếu</h2>
                            </div>
                            <div class="card-body">
                                <div class="subjects-list" id="subjects-list">
                                    <!-- Generated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="right-column">
                        <!-- Study Roadmap -->
                        <div class="card">
                            <div class="card-header">
                                <div class="header-icon roadmap">
                                    <i class="fa-solid fa-route"></i>
                                </div>
                                <h2>Lộ trình ôn tập</h2>
                            </div>
                            <div class="card-body">
                                <div class="roadmap-timeline" id="roadmap-timeline">
                                    <!-- Generated by JS -->
                                </div>
                            </div>
                        </div>

                        <!-- Alternative Schools with Fit Score -->
                        <div class="card">
                            <div class="card-header">
                                <div class="header-icon alternatives">
                                    <i class="fa-solid fa-school"></i>
                                </div>
                                <h2>Gợi ý ngành thay thế</h2>
                            </div>
                            <div class="card-body">
                                <div class="alternatives-list" id="alternatives-list">
                                    <!-- Generated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bottom: Chat with AI -->
                <div class="card chat-card">
                    <div class="card-header">
                        <div class="header-icon chat">
                            <i class="fa-solid fa-comments"></i>
                        </div>
                        <h2>Hỏi AI thêm</h2>
                        <button class="btn-icon" onclick="clearInlineChat()" title="Xóa hội thoại">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="inline-chat">
                            <!-- Quick Actions -->
                            <div class="quick-actions" id="quick-actions">
                                <button class="quick-btn"
                                    onclick="askQuickQuestion('Làm thế nào để cải thiện điểm Toán nhanh nhất?')">
                                    <i class="fa-solid fa-calculator"></i> Cải thiện Toán
                                </button>
                                <button class="quick-btn"
                                    onclick="askQuickQuestion('Cho tôi lịch ôn tập chi tiết theo tuần')">
                                    <i class="fa-solid fa-calendar-week"></i> Lịch ôn tập
                                </button>
                                <button class="quick-btn"
                                    onclick="askQuickQuestion('Môn nào tôi nên tập trung nhất để đậu?')">
                                    <i class="fa-solid fa-bullseye"></i> Môn ưu tiên
                                </button>
                                <button class="quick-btn"
                                    onclick="askQuickQuestion('Có nên chọn ngành khác an toàn hơn?')">
                                    <i class="fa-solid fa-school"></i> Ngành thay thế
                                </button>
                            </div>

                            <!-- Messages Container -->
                            <div class="chat-container" id="chat-container">
                                <div class="chat-messages" id="inline-chat-messages">
                                    <!-- Empty state shown initially -->
                                    <div class="chat-empty" id="chat-empty">
                                        <i class="fa-solid fa-robot"></i>
                                        <p>Hỏi bất cứ điều gì về lộ trình ôn tập của bạn!</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Input Form -->
                            <form class="chat-input-form" id="inline-chat-form">
                                <input type="text" id="inline-chat-input" placeholder="Nhập câu hỏi của bạn..."
                                    autocomplete="off">
                                <button type="submit" class="btn-send" id="btn-send">
                                    <i class="fa-solid fa-paper-plane"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 EduPath - Hệ thống Tư vấn Tuyển sinh Thông minh</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/config.local.js" onerror="console.log('Running in production mode')"></script>
    <script src="js/personalize.js"></script>
</body>

</html>